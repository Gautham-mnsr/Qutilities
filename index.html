<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0"/>
<title>Assistant App with Timer, Stopwatch, Currency, Map, Time & Language Converter</title>
<link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
<style>
  body { font-family: Arial,sans-serif; margin:0; background:#f4f4f4; }
  header { background:#4e89ae; color:white; padding:1rem; text-align:center; position:sticky; top:0; z-index:10; }
  .menu { display:flex; justify-content:center; gap:1rem; margin-top:1rem; flex-wrap:wrap; }
  .menu a { text-decoration:none; color:white; background:#3a6b8a; padding:.5rem 1rem; border-radius:5px; }
  .menu a.active { background:#ed6663; }
  .container { padding:2rem; max-width:900px; margin:auto; }
  .section { display:none; }
  .section.active { display:block; }
  textarea,input,select { width:100%; margin-bottom:1rem; padding:.7rem; border-radius:5px; border:1px solid #ccc; font-size:1rem; box-sizing:border-box; }
  select[size] { height:auto; }
  button { padding:.7rem 1.2rem; font-size:1rem; background:#4e89ae; color:white; border:none; border-radius:5px; cursor:pointer; margin-right:.5rem; margin-bottom:.5rem; }
  #display { font-size:1.5rem; text-align:right; }
  #keys { display:grid; grid-template-columns:repeat(4,1fr); gap:.5rem; }
  #map-container { height:400px; width:100%; margin-top:1rem; border:1px solid #ccc; border-radius:8px; }
  #currency-result,#unit-result,#translated-text { font-size:1.3rem; margin-top:1rem; font-weight:bold; color:#333; }
  .timer-stopwatch-container { max-width:400px; margin:0 auto; background:#fff; padding:1.5rem; border-radius:8px; box-shadow:0 2px 8px rgba(0,0,0,.07); }
  .timer-stopwatch-container h3 { margin-top:0; }
  .timer-display,.stopwatch-display { font-size:2.2rem; font-family:'Courier New',Courier,monospace; text-align:center; margin:1rem 0; letter-spacing:2px; }
  .timer-controls,.stopwatch-controls { text-align:center; }
  .timer-inputs { display:flex; justify-content:center; gap:.5rem; margin-bottom:1rem; }
  .timer-inputs input { width:60px; text-align:center; }
</style>
</head>

<body>
<header>
  <h1>Assistant App</h1>
  <div class="menu">
    <a href="#" class="active" data-section="calculator">Calculator</a>
    <a href="#" data-section="map">Map</a>
    <a href="#" data-section="time">Time Converter</a>
    <a href="#" data-section="currency">Currency Converter</a>
    <a href="#" data-section="unit">Unit Converter</a>
    <a href="#" data-section="translator">Language Translator</a>
    <a href="#" data-section="timerstopwatch">Timer & Stopwatch</a>
  </div>
</header>

<div class="container">

<!-- Calculator -->
<div id="calculator" class="section active">
  <input type="text" id="display" readonly>
  <div id="keys">
    <button onclick="appendToDisplay('7')">7</button>
    <button onclick="appendToDisplay('8')">8</button>
    <button onclick="appendToDisplay('9')">9</button>
    <button onclick="appendToDisplay('+')">+</button>
    <button onclick="appendToDisplay('4')">4</button>
    <button onclick="appendToDisplay('5')">5</button>
    <button onclick="appendToDisplay('6')">6</button>
    <button onclick="appendToDisplay('-')">-</button>
    <button onclick="appendToDisplay('1')">1</button>
    <button onclick="appendToDisplay('2')">2</button>
    <button onclick="appendToDisplay('3')">3</button>
    <button onclick="appendToDisplay('*')">*</button>
    <button onclick="appendToDisplay('0')">0</button>
    <button onclick="appendToDisplay('.')">.</button>
    <button onclick="clearDisplay()">C</button>
    <button onclick="calculate()">=</button>
    <button onclick="appendToDisplay('/')">/</button>
  </div>
</div>

<!-- Map -->
<div id="map" class="section">
  <input type="text" id="place-input" placeholder="Enter place name">
  <button onclick="searchPlace()">Show on Map</button>
  <div id="map-container"></div>
</div>

<!-- Time Converter -->
<div id="time" class="section">
  <label>Time in IST</label>
  <input type="time" id="ist-time" value="12:00">
  <label>Select Timezone</label>
  <select id="timezone-select" size="6" style="width:100%; margin-bottom:1rem;">
    <option value="America/New_York">New York (EST/EDT)</option>
    <option value="Europe/London">London (GMT/BST)</option>
    <option value="Asia/Tokyo">Tokyo (JST)</option>
    <option value="Australia/Sydney">Sydney (AEST/AEDT)</option>
    <option value="Europe/Paris">Paris (CET/CEST)</option>
    <option value="Asia/Dubai">Dubai (GST)</option>
  </select>
  <button onclick="convertTime()">Convert</button>
  <div id="converted-time"></div>
</div>

<!-- Currency Converter -->
<div id="currency" class="section">
  <label>Amount</label>
  <input type="number" id="currency-amount" value="1" min="0" step="any">
  <label>From</label>
  <select id="currency-from"></select>
  <label>To</label>
  <select id="currency-to"></select>
  <button onclick="convertCurrency()">Convert</button>
  <div id="currency-result"></div>
</div>

<!-- Unit Converter -->
<div id="unit" class="section">
  <label>Category</label>
  <select id="unit-category">
    <option value="length">Length</option>
    <option value="weight">Weight</option>
    <option value="area">Area</option>
    <option value="volume">Volume</option>
    <option value="temperature">Temperature</option>
  </select>
  <label>From</label>
  <select id="unit-from"></select>
  <label>To</label>
  <select id="unit-to"></select>
  <label>Value</label>
  <input type="number" id="unit-value" placeholder="Enter value">
  <button onclick="convertUnit()">Convert</button>
  <div id="unit-result"></div>
</div>

<!-- Language Translator -->
<div id="translator" class="section">
  <label>English</label>
  <textarea id="englishText" placeholder="Type in English..."></textarea>
  <label>Malayalam</label>
  <textarea id="malayalamText" placeholder="മലയാളത്തിൽ എഴുതൂ..."></textarea>
  <label>Hindi</label>
  <textarea id="hindiText" placeholder="हिंदी में लिखें..."></textarea>
</div>

<!-- Timer & Stopwatch -->
<div id="timerstopwatch" class="section">
  <div class="timer-stopwatch-container">
    <h3>Timer</h3>
    <div class="timer-inputs">
      <input type="number" id="timer-minutes" placeholder="MM" value="0">
      <input type="number" id="timer-seconds" placeholder="SS" value="0">
    </div>
    <div class="timer-display" id="timer-display">00:00</div>
    <div class="timer-controls">
      <button onclick="startTimer()" id="timer-start">Start</button>
      <button onclick="pauseTimer()" id="timer-pause" disabled>Pause</button>
      <button onclick="resetTimer()" id="timer-reset">Reset</button>
    </div>
    <audio id="timer-sound" src="https://actions.google.com/sounds/v1/alarms/alarm_clock.ogg" preload="auto"></audio>
  </div>

  <div class="timer-stopwatch-container" style="margin-top:2rem;">
    <h3>Stopwatch</h3>
    <div class="stopwatch-display" id="stopwatch-display">00:00:00</div>
    <div class="stopwatch-controls">
      <button onclick="startStopwatch()" id="stopwatch-start">Start</button>
      <button onclick="pauseStopwatch()" id="stopwatch-pause" disabled>Pause</button>
      <button onclick="resetStopwatch()" id="stopwatch-reset">Reset</button>
    </div>
  </div>
</div>

<script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
<script>
/* ---------------- Navigation ---------------- */
document.querySelectorAll('.menu a').forEach(link=>{
  link.addEventListener('click',e=>{
    e.preventDefault();
    document.querySelectorAll('.menu a').forEach(a=>a.classList.remove('active'));
    link.classList.add('active');
    document.querySelectorAll('.section').forEach(s=>s.classList.remove('active'));
    document.getElementById(link.dataset.section).classList.add('active');
    if(link.dataset.section==="map"&&window.map){ setTimeout(()=>map.invalidateSize(),200); }
  });
});

/* ---------------- Calculator ---------------- */
const display=document.getElementById('display');
function appendToDisplay(val){ display.value+=val; }
function clearDisplay(){ display.value=''; }
function calculate(){ try{ display.value=eval(display.value); }catch{ display.value='Error';}}

/* ---------------- Map ---------------- */
let map=L.map('map-container').setView([20,77],5);
L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png',{ attribution:'&copy; OpenStreetMap contributors'}).addTo(map);
let marker;
async function searchPlace(){
  const place=document.getElementById('place-input').value;
  if(!place)return;
  const res=await fetch(`https://nominatim.openstreetmap.org/search?format=json&q=${encodeURIComponent(place)}`);
  const data=await res.json();
  if(data.length>0){
    const {lat, lon}=data[0];
    if(marker) map.removeLayer(marker);
    marker=L.marker([lat,lon]).addTo(map);
    map.setView([lat,lon],14);
  }else alert('Place not found!');
}

/* ---------------- Time Converter ---------------- */
function convertTime(){
  const istTime=document.getElementById('ist-time').value;
  const tz=document.getElementById('timezone-select').value;
  if(!istTime) return;
  const [h,m]=istTime.split(':').map(Number);
  const date=new Date();
  const utc=new Date(Date.UTC(date.getFullYear(),date.getMonth(),date.getDate(),h-5,m-30));
  try{
    const options={hour:'2-digit',minute:'2-digit',hour12:false,timeZone:tz};
    const formatted=new Intl.DateTimeFormat('en-US',options).format(utc);
    document.getElementById('converted-time').textContent=`Time: ${formatted}`;
  }catch(e){ document.getElementById('converted-time').textContent="Conversion error"; }
}

/* ---------------- Currency Converter ---------------- */
const currencyFrom=document.getElementById('currency-from');
const currencyTo=document.getElementById('currency-to');
const currencyList=["AUD","BGN","BRL","CAD","CHF","CNY","CZK","DKK","EUR","GBP","HKD","HRK","HUF","IDR","ILS","INR","ISK","JPY","KRW","MXN","MYR","NOK","NZD","PHP","PLN","RON","RUB","SEK","SGD","THB","TRY","USD","ZAR"];
currencyList.forEach(c=>{ let opt1=document.createElement('option'); opt1.value=c; opt1.text=c; currencyFrom.appendChild(opt1); let opt2=document.createElement('option'); opt2.value=c; opt2.text=c; currencyTo.appendChild(opt2);});
currencyFrom.value="USD"; currencyTo.value="INR";

async function convertCurrency(){
  const amount=parseFloat(document.getElementById('currency-amount').value);
  const from=currencyFrom.value; const to=currencyTo.value;
  if(isNaN(amount)||amount<=0){ document.getElementById('currency-result').textContent="Invalid amount"; return;}
  if(from===to){ document.getElementById('currency-result').textContent="Select different currencies"; return;}
  document.getElementById('currency-result').textContent="Converting...";
  try{
    const res=await fetch(`https://api.frankfurter.app/latest?amount=${amount}&from=${from}&to=${to}`);
    const data=await res.json();
    document.getElementById('currency-result').textContent=`${amount} ${from} = ${data.rates[to].toFixed(4)} ${to}`;
  }catch{ document.getElementById('currency-result').textContent="Conversion failed"; }
}

/* ---------------- Unit Converter ---------------- */
const unitDefinitions={length:{units:{meter:1,kilometer:1000,centimeter:0.01,millimeter:0.001,mile:1609.34,yard:0.9144,foot:0.3048,inch:0.0254}},
weight:{units:{kilogram:1,gram:0.001,milligram:0.000001,pound:0.453592,ounce:0.0283495}},
area:{units:{'square meter':1,'square kilometer':1e6,'square centimeter':0.0001,'square millimeter':0.000001,'square mile':2.59e6,'square yard':0.836127,'square foot':0.092903,'square inch':0.00064516,hectare:10000,acre:4046.86}},
volume:{units:{liter:1,milliliter:0.001,'cubic meter':1000,'cubic centimeter':0.001,'US gallon':3.78541,'US quart':0.946353,'US pint':0.473176,'US cup':0.24,'US fluid ounce':0.0295735,'UK gallon':4.54609}},
temperature:{units:{Celsius:'C',Fahrenheit:'F',Kelvin:'K'}}};

function populateUnitDropdowns(){
  const cat=document.getElementById('unit-category').value;
  const from=document.getElementById('unit-from'); const to=document.getElementById('unit-to');
  from.innerHTML=''; to.innerHTML='';
  Object.keys(unitDefinitions[cat].units).forEach(u=>{
    let o1=document.createElement('option'); o1.value=u; o1.text=u; from.appendChild(o1);
    let o2=document.createElement('option'); o2.value=u; o2.text=u; to.appendChild(o2);
  });
  to.selectedIndex=1;
}
document.getElementById('unit-category').addEventListener('change',populateUnitDropdowns);
populateUnitDropdowns();

function convertUnit(){
  const cat=document.getElementById('unit-category').value;
  const from=document.getElementById('unit-from').value;
  const to=document.getElementById('unit-to').value;
  const val=parseFloat(document.getElementById('unit-value').value);
  if(isNaN(val)){ document.getElementById('unit-result').textContent="Enter valid value"; return; }
  if(from===to){ document.getElementById('unit-result').textContent=`${val} ${from} = ${val} ${to}`; return;}
  let res;
  if(cat==='temperature'){
    res=convertTemperature(val,unitDefinitions.temperature.units[from],unitDefinitions.temperature.units[to]);
    if(res===null){ document.getElementById('unit-result').textContent="Conversion not supported"; return; }
    document.getElementById('unit-result').textContent=`${val} ${from} = ${res.toFixed(2)} ${to}`;
  }else{
    res=val*unitDefinitions[cat].units[from]/unitDefinitions[cat].units[to];
    document.getElementById('unit-result').textContent=`${val} ${from} = ${res.toFixed(6)} ${to}`;
  }
}
function convertTemperature(val,from,to){
  if(from===to) return val;
  let c;if(from==='C') c=val; else if(from==='F') c=(val-32)*5/9; else if(from==='K') c=val-273.15;
  if(to==='C') return c;if(to==='F') return c*9/5+32;if(to==='K') return c+273.15;
  return null;
}

/* ---------------- Language Translator ---------------- */
let isTranslating=false;
function translate(from,to,inputId,outputId){
  const text=document.getElementById(inputId).value;
  if(!text) return;
  isTranslating=true;
  fetch(`https://translate.googleapis.com/translate_a/single?client=gtx&sl=${from}&tl=${to}&dt=t&q=${encodeURIComponent(text)}`)
    .then(res=>res.json())
    .then(data=>{ document.getElementById(outputId).value=data[0][0][0]; isTranslating=false; })
    .catch(()=>{ document.getElementById(outputId).value='Error'; isTranslating=false; });
}

document.getElementById('englishText').addEventListener('input',()=>{
  if(isTranslating) return;
  translate('en','ml','englishText','malayalamText');
  translate('en','hi','englishText','hindiText');
});
document.getElementById('malayalamText').addEventListener('input',()=>{
  if(isTranslating) return;
  translate('ml','en','malayalamText','englishText');
  translate('ml','hi','malayalamText','hindiText');
});
document.getElementById('hindiText').addEventListener('input',()=>{
  if(isTranslating) return;
  translate('hi','en','hindiText','englishText');
  translate('hi','ml','hindiText','malayalamText');
});

/* ---------------- Timer ---------------- */
let timerInterval,timerRemaining=0;
function startTimer(){
  const min=parseInt(document.getElementById('timer-minutes').value)||0;
  const sec=parseInt(document.getElementById('timer-seconds').value)||0;
  timerRemaining=min*60+sec;
  if(timerRemaining<=0) return;
  document.getElementById('timer-start').disabled=true;
  document.getElementById('timer-pause').disabled=false;
  updateTimerDisplay();
  timerInterval=setInterval(()=>{
    timerRemaining--;
    updateTimerDisplay();
    if(timerRemaining<=0){ clearInterval(timerInterval); document.getElementById('timer-sound').play(); document.getElementById('timer-start').disabled=false; document.getElementById('timer-pause').disabled=true; }
  },1000);
}
function pauseTimer(){ clearInterval(timerInterval); document.getElementById('timer-start').disabled=false; document.getElementById('timer-pause').disabled=true; }
function resetTimer(){ clearInterval(timerInterval); timerRemaining=0; document.getElementById('timer-display').textContent='00:00'; document.getElementById('timer-start').disabled=false; document.getElementById('timer-pause').disabled=true;}
function updateTimerDisplay(){ const m=Math.floor(timerRemaining/60).toString().padStart(2,'0'); const s=(timerRemaining%60).toString().padStart(2,'0'); document.getElementById('timer-display').textContent=`${m}:${s}`;}

/* ---------------- Stopwatch ---------------- */
let stopwatchInterval,stopwatchSeconds=0;
function startStopwatch(){ document.getElementById('stopwatch-start').disabled=true; document.getElementById('stopwatch-pause').disabled=false; stopwatchInterval=setInterval(()=>{ stopwatchSeconds++; updateStopwatchDisplay(); },1000);}
function pauseStopwatch(){ clearInterval(stopwatchInterval); document.getElementById('stopwatch-start').disabled=false; document.getElementById('stopwatch-pause').disabled=true; }
function resetStopwatch(){ clearInterval(stopwatchInterval); stopwatchSeconds=0; updateStopwatchDisplay(); document.getElementById('stopwatch-start').disabled=false; document.getElementById('stopwatch-pause').disabled=true;}
function updateStopwatchDisplay(){ const h=Math.floor(stopwatchSeconds/3600).toString().padStart(2,'0'); const m=Math.floor((stopwatchSeconds%3600)/60).toString().padStart(2,'0'); const s=(stopwatchSeconds%60).toString().padStart(2,'0'); document.getElementById('stopwatch-display').textContent=`${h}:${m}:${s}`;}
</script>
</body>
</html>
